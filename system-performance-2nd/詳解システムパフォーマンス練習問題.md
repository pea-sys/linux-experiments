## メソドロジ

- 1. パフォーマンスの基本用語についての以下の問いに答えなさい

  - IOPS とは何か  
    (答)秒あたりの入出力回数

  * 使用率とは何か  
    (答)リソースがどの程度の割合使用されているかを表した指標
  * 飽和とは何か  
    (答)リソースで即時処理できずにキューイングされた処理
  * レイテンシとは何か  
    (答)目的の処理が実行されるまでの時間
  * マイクロベンチマーキングとは何か  
    (答)特定処理の処理速度を測定する手段

- 2. あなたの環境で使うメソドロジを５つ選びなさい。実践する順序で並べ、個々のメソドロジを選んだ理由を説明しなさい
  - 1. 問題の記述  
       理由)  
       スタンドアローンの組み込みソフトを提供しているため、リモートでのログ等の確認が出来ない。  
       まずは、電話での状況確認になる。
  - 2. 科学的メソッド  
       理由)  
       電話超しの問診で特定できない場合は、ログを送ってもらう。  
       ログから遅くなっている箇所はある程度絞れるのと、リソースの状況もある程度掴めるようになるので仮説が立てられる。
  - 3. USE メソッド  
       理由)  
        これまでの経験に基づいた分析で原因が分からなかった場合は、
       手続きに沿った定型の診断を行う。USE メソッドは手早く出来る。
  - 4. ドリルダウン分析  
       理由)  
       定型の簡易診断で原因が掴めない場合は、高次から掘り下げを繰り返し、原因特定を行う
  - 5. パフォーマンスマントラ  
       理由)  
        原因が特定できたらパフォーマンスマントラに沿って対策を検討・実施する

* 3. 唯一のパフォーマンス指標として平均レイテンシを使ったときの問題点を簡潔に説明しなさい、99 パーセンタイルを含めれば、その問題は解決できるか  
     解答)  
     問題点は統計値として平均を採用している点。パフォーマンスにばらつきがある場合は、悪い時のパフォーマンスは平均によりほとんど隠される可能性が高い。  
     また、99 パーセントタイルは単峰分布を対象としたものであるが、多くの場合、システムパフォーマンスは 2 峰以上の分布であるため、表現として適していない場合がある。

## オペレーティングシステム

- 1. OS 用語について以下の問いに応えなさい
  - プロセス、スレッド、タスクの違いは何か
    解答)  
    プロセスはプログラムの実行環境。スレッドはスケジューリング可能な実行コンテキストであり、プロセスは複数のスレッドを持ちうる。タスクは処理の実行単位である。
  - モードスイッチとコンテキストスイッチとは何か  
    解答)  
    モードスイッチはカーネルモードとユーザーモードを切り替えるスイッチ。コンテキストスイッチはスレッドやプロセスを切り替えるスイッチ
  - ページングとスワッピングの違いは何か  
    解答)  
    ページングは仮想メモリのデータを物理メモリに読み書きすること。スワッピングはメモリとディスクのデータを交換し、実メモリより多くのデータを透過的に扱う。
  - I/O バウンドワークロードと CPU バウンドワークロードの違いは何か  
    解答)  
    I/O バウンドワークロードは CPU にほとんど負荷をかけないが、CPU バウンドワークロードは CPU への負担が大きい。
- 2. コンセプトについて以下の問いに答えなさい

  - カーネルの役割を説明しなさい  
    解答)
    カーネルは OS の中核となる機能を有する。
  - システムコールの役割を説明しなさい  
    解答)  
    カーネルモードで動く処理のインターフェース提供する
  - VFS の役割と I/O スタック内での位置を説明しなさい  
    解答)  
    ファイルシステムを抽象化する役割で、ファイルシステムの上層に位置する

- 3. 難易度の高い以下の問いに答えなさい

  - スレッドが CPU を手放す理由を列挙しなさい  
    解答)
    - 割込み処理を可能にするため
    * 消費電力の浪費を防ぐため
    * 非同期処理を可能にするため
    * モードスイッチを可能にするため
  - 仮想メモリとデマンドページングの利点を説明しなさい  
    解答)  
    仮想メモリにより実メモリより多くのデータを取り扱える  
    仮想メモリへの読み書きは時間が掛かるため、デマンドページングにより実際に必要になったタイミングで最小限のページのみを実メモリにロードして、最小限のコストでデータを読み書き可能とする。

## 可観測性ツール

- 1. 静的パフォーマンスツールの例を挙げなさい  
     解答)  
     df, dmesg, sysctl
- 2. プロファイリングとは何か  
     解答)  
     分析手法。測定し、問題点を検出・特定するために使用する。
- 3. プロファイラが 100Hz ではなく 99Hz を使うのはなぜか  
     解答)  
     ターゲットのサンプリングと歩調が合わないようにするため。  
     計測値がぶれやすくなる。
- 4. トレーシングとは何か  
     解答)  
     処理やデータの流れを追跡すること
- 5. 静的インストルメンテーションとは何か  
     解答)  
     ハードコードされたトレーシングポイント
- 6. 動的インストルメンテーションが重要な理由を説明しなさい  
     解答)  
     本番稼働しているカーネルから静的インストール面テーションでは取り出せない任意の情報を取り出せる。問題の観察をするための最後の手段として重要。
- 7. トレースポイントと kprobe の違いは何か  
     解答)  
     トレースポイントとは静的インストルメンテーションのイベントソース  
     kprobe は動的インストルメンテーションのイベントソース
- 8. 以下の作業で予想される CPU のオーバーヘッド(低いか普通か高いか)を説明しなさい

  - ディスクの IOPS カウンタ(iostat(1)で見られるもの)  
    解答)  
    オーバーヘッドは低い。カーネルがデフォルトで有効にしているため。
  - トレーシングポイントが kprobe を使ったディスク I/O ごとのトレーシング  
    解答)  
    kretprobe を使用することになるのでオーバーヘッドは低くないが、ディスク I/O のコストと比較すると普通程度と予想。
  - トレーシングポイントが kprobe を使ったコンテキストスイッチごとのトレーシング  
     解答)  
    関数開始ポイントのみのトーレシングポイントになるのでオーバーヘッドは低い。
  - トレーシングポイントが kprobe を使ったプロセスの起動(execve(2))ごとのトレーシング  
    解答)  
    関数開始ポイントのみのトーレシングポイントになるのでオーバーヘッドは低い。
  - uprobe を使った libc_malloc()が呼び出しごとのトレーシング  
    解答)  
    関数開始ポイントのみのトーレシングポイントになるのでオーバーヘッドは低い。

- 9. パフォーマンス分析で PMC に価値がある理由を説明しなさい  
     解答)  
     PMC でのみ得られるプロセッサのプロファイル情報から、CPU の使い方を最適化できる。

- 10. 可観測性ツールが与えられたとき、どうすればそれが使っているインストルメンテーションを明らかにできるか説明しなさい  
      解答)  
      ツールが提供する統計量と一致する情報を提供する標準的なツールを探し出し、ソースコードを辿る。
